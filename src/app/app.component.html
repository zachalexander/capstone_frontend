<div class="title">
        <h1>Long-term financial projection of installing solar <br> panels on your home</h1>
</div>

<div class="intro">
        <small>
                Solar panel arrays are often marketed by the number of kW they can 
                produce. This number is actually what the system would produce assuming 
                they receive full sunlight for at least 8 hours in a day. In reality the 
                amount of kW they produce depends largely on the sunlight your rooftop is 
                exposed to. <br><br>
                The following calculator is meant to take into account the sunlight in your 
                area and provide estimates of certain panel system sizes (since you are often 
                limited by the size of your roof) as well as their efficiencies.
        </small>
</div>



<div class="searchDiv">
        <AutocompleteComponent (setAddress)="getAddress($event)" addressType="geocode"></AutocompleteComponent>
        <button class="button-right" id="submit" mat-raised-button type="submit" color="primary" (click)="goForward(stepper)">Search</button>
</div>
<div id='map' style="width:100%;height:400px"></div>

<div class="stepper">
        <mat-vertical-stepper [linear]="isLinear" #stepper>
                <mat-step label="Please search for your household address above.">
                </mat-step>

                <mat-step [stepControl]="secondFormGroup" label="What is the square footage (ft) of your house?">
                <form [formGroup]="secondFormGroup">
                <mat-form-field>
                <mat-label></mat-label>
                <div class="idk_layout">
                        <input matInput formControlName="secondCtrl" placeholder="1,200">
                </div>
                </mat-form-field>
                <div>
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button matStepperNext (click)="squareFootageSubmit()">Next</button>
                </div>
                </form>
                </mat-step>

                <mat-step [stepControl]="firstFormGroup">
                <form [formGroup]="firstFormGroup">
                <ng-template matStepLabel>Roughly, what year was your house built?</ng-template>
                <mat-form-field>
                <mat-label>Estimated year</mat-label>
                <input matInput placeholder="4" formControlName="firstCtrl" required>
                </mat-form-field>
                <div>
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button matStepperNext (click)="yearBuiltSubmit()">Next</button>
                </div>
                </form>
                </mat-step>

                <mat-step label="Use the measurement tool to calculate the area of the solar array you'd like installed on your roof.">
                        <div class="surfaceArea">
                                <p>According to Google's Project Sunroof, the recommended solar panel array size for your roof is: <strong>{{recSq | number }} ft&#178;</strong></p>
                                <button mat-button (click)="getFootage()" color='warn'>SunRoof Estimate</button>
                        </div>

                        <div *ngIf="!hideQuestion" class="checkUser">
                                <p>Does that seem accurate to you?</p>
                                <button mat-button (click)="yesConfirm()" color='primary'>Yes</button>
                                <button mat-button (click)="noConfirm()" color='warn'>No</button>
                        </div>

                        <div *ngIf="no" class="manualDraw">
                                <p>Click the "Estimate Manually" button and then draw a shape directly on your roof to estimate the surface area:</p>
                                <button *ngIf=draw (click)="measureManually()" mat-button color='primary'>Estimate Manually</button>
                                <button *ngIf=draw (click)="reDraw()" mat-button color='warn'>Re-draw</button>
                        </div>
                        
                        <div class="finalConfirm">
                                <p *ngIf="!confirmSf">Estimated size of your solar array: <strong id="square-feet">{{ measureTool._area | number}}</strong><strong> ft&#178;</strong></p>
                                <p *ngIf="confirmSf">Estimated size of your solar array: <strong id="sunroof-square-feet">{{ roofArea }}</strong><strong> ft&#178;</strong></p>
                                <button *ngIf=draw (click)="confirmFootage(stepper)" mat-raised-button color="primary">Confirm square footage</button>
                        </div>
                </mat-step>

                <mat-step label="Identify the orientation of your roof.">
                        <div class="manualDraw">
                                <p>Find the ridge of your roof, select the "Draw" button, and draw a line with two points along the pitch:</p>
                                <button *ngIf=draw (click)="measureTool.start()" mat-button color='primary'>Draw</button>
                                <button *ngIf=draw (click)="measureTool.end()" mat-button color='warn'>Re-draw</button>
                        </div>
                        <div class="findOrient">
                                <p>Once you've drawn a line across your roof, click the "Find orientation" button.</p>
                                <button mat-button (click)="calculateHeading()" color="primary">Find orientation</button>
                        </div>
                        <div class="azimuth">
                                <p>Estimated orientation of your roof: <strong>{{heading | number}} &deg;</strong></p>
                        </div>
                        <button *ngIf=confirm (click)="goForward(stepper)" mat-raised-button color="primary">Confirm orientation</button>
                </mat-step>
                
                
                <mat-step>
                <ng-template matStepLabel>Run the solar calculator for your home</ng-template>
                <button *ngIf="!modelRun" (click)="postClick()" mat-raised-button color="primary">Get Cost Breakdown</button>
                <div class="runModel">
                <p *ngIf="modelRun">Processing...</p>
                </div>
                </mat-step>
        </mat-vertical-stepper>
</div>

<app-linechart *ngIf="graphData" [data]="graphData"></app-linechart>







<router-outlet></router-outlet>